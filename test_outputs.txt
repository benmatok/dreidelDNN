Running Regression Suite...
Date: Wed Dec 24 04:18:41 UTC 2025
--------------------------------------------------
Running Test test_allocator...
Disk Usage:
/dev/vdb                  98G   12G   82G  13% /rom/overlay
overlayfs:/overlay/root   98G   12G   82G  13% /
Memory Usage:
               total        used        free      shared  buff/cache   available
Mem:           7.8Gi       480Mi       3.2Gi       544Ki       4.4Gi       7.3Gi
Swap:             0B          0B          0B
Compiling tests/test_allocator.cpp...
Running tests/test_allocator...
Testing Odd Allocation Alignment...
PASS
[PASS] Test test_allocator
--------------------------------------------------
Running Test test_alsh...
Disk Usage:
/dev/vdb                  98G   12G   82G  13% /rom/overlay
overlayfs:/overlay/root   98G   12G   82G  13% /
Memory Usage:
               total        used        free      shared  buff/cache   available
Mem:           7.8Gi       550Mi       3.1Gi       548Ki       4.4Gi       7.2Gi
Swap:             0B          0B          0B
Compiling tests/test_alsh.cpp...
Running tests/test_alsh...
Running ALSH Test...
Index build time: 119 ms
Brute Force Time: 5165 us
ALSH Query Time (incl. re-rank): 185 us
Candidates count: 115 / 10000
Recall @ 10: 10 / 10 (100%)
Test Passed: Retrieved at least some relevant items.
[PASS] Test test_alsh
--------------------------------------------------
Running Test test_audio...
Disk Usage:
/dev/vdb                  98G   12G   82G  13% /rom/overlay
overlayfs:/overlay/root   98G   12G   82G  13% /
Memory Usage:
               total        used        free      shared  buff/cache   available
Mem:           7.8Gi       584Mi       3.1Gi       548Ki       4.4Gi       7.2Gi
Swap:             0B          0B          0B
Compiling tests/test_audio.cpp...
Running tests/test_audio...
Testing FFT...
FFT Passed.
Testing AudioEncoder...
Output shape: 1 80 101
Max Mel Value: 3.97276
AudioEncoder Passed.
[PASS] Test test_audio
--------------------------------------------------
Running Test test_conv3d_spectral...
Disk Usage:
/dev/vdb                  98G   12G   82G  13% /rom/overlay
overlayfs:/overlay/root   98G   12G   82G  13% /
Memory Usage:
               total        used        free      shared  buff/cache   available
Mem:           7.8Gi       637Mi       3.0Gi       548Ki       4.4Gi       7.1Gi
Swap:             0B          0B          0B
Compiling tests/test_conv3d_spectral.cpp...
Running tests/test_conv3d_spectral...
Testing Conv3DSpectral Forward...
Output[0]: 2 (Expected 2.0)
Output[1]: 0 (Expected 0.0)
PASS
Testing Conv3DSpectral Backward...
Grad Input[0]: 2 (Expected 2.0)
Grad Input[1]: 0 (Expected 0.0)
PASS
[PASS] Test test_conv3d_spectral
--------------------------------------------------
Running Test test_deep_spectral...
Disk Usage:
/dev/vdb                  98G   12G   82G  13% /rom/overlay
overlayfs:/overlay/root   98G   12G   82G  13% /
Memory Usage:
               total        used        free      shared  buff/cache   available
Mem:           7.8Gi       704Mi       2.9Gi       548Ki       4.4Gi       7.1Gi
Swap:             0B          0B          0B
Compiling tests/test_deep_spectral.cpp...
Running tests/test_deep_spectral...
Testing DeepSpectralLinear Forward/Backward...
Forward Pass Complete.
Backward Pass Complete.
Testing Overfitting Random Matrix...
Epoch 0 MSE: 2.12244
Epoch 50 MSE: 1.65031
Epoch 100 MSE: 1.32649
Epoch 150 MSE: 1.26483
Epoch 200 MSE: 1.23469
Epoch 250 MSE: 1.26551
Epoch 300 MSE: 1.20596
Epoch 350 MSE: 1.10629
Epoch 400 MSE: 1.12237
Epoch 450 MSE: 1.05085
Training Complete.
[PASS] Test test_deep_spectral
--------------------------------------------------
Running Test test_linear_wht...
Disk Usage:
/dev/vdb                  98G   12G   82G  13% /rom/overlay
overlayfs:/overlay/root   98G   12G   82G  13% /
Memory Usage:
               total        used        free      shared  buff/cache   available
Mem:           7.8Gi       730Mi       2.9Gi       548Ki       4.4Gi       7.1Gi
Swap:             0B          0B          0B
Compiling tests/test_linear_wht.cpp...
Running tests/test_linear_wht...
Testing LinearWHT Forward...
Output[0]: 4 (Expected 4.0)
Output[1]: 0 (Expected 0.0)
PASS
Testing LinearWHT Backward...
Grad Input[0]: 0.5 (Expected 0.5)
Grad Scale[0]: 1 (Expected 1.0)
PASS
Testing LinearWHT TopK...
Output: 10 0 4 0
PASS
[PASS] Test test_linear_wht
--------------------------------------------------
Running Test test_mnist_mock...
Disk Usage:
/dev/vdb                  98G   12G   82G  13% /rom/overlay
overlayfs:/overlay/root   98G   12G   82G  13% /
Memory Usage:
               total        used        free      shared  buff/cache   available
Mem:           7.8Gi       779Mi       2.9Gi       548Ki       4.4Gi       7.0Gi
Swap:             0B          0B          0B
Compiling tests/test_mnist_mock.cpp...
Running tests/test_mnist_mock...
--- Testing Mock MNIST Training with LinearWHT ---
Initial Loss: 2.3031
Final Loss: 0.826699
PASS: Training loop ran successfully.
[PASS] Test test_mnist_mock
--------------------------------------------------
Running Test test_phase8...
Disk Usage:
/dev/vdb                  98G   12G   82G  13% /rom/overlay
overlayfs:/overlay/root   98G   12G   82G  13% /
Memory Usage:
               total        used        free      shared  buff/cache   available
Mem:           7.8Gi       714Mi       2.9Gi       548Ki       4.4Gi       7.1Gi
Swap:             0B          0B          0B
Compiling tests/test_phase8.cpp...
Running tests/test_phase8...
--- Testing WHT Hasher ---
Hamming Distance (Similar vectors): 0
PASS: Hasher preserves locality.
--- Testing Sparse Gather ---
PASS: Sparse Gather correct.
--- Benchmarking Filter Pruning (Simulation) ---
Sparse Compute Time (Gather+Dot): 0.0117035 s
Dense Compute Time (Full Dot): 0.0628432 s
Speedup: 5.3696x
PASS: Speedup observed.
[PASS] Test test_phase8
--------------------------------------------------
Running Test test_rosenbrock...
Disk Usage:
/dev/vdb                  98G   12G   82G  13% /rom/overlay
overlayfs:/overlay/root   98G   12G   82G  13% /
Memory Usage:
               total        used        free      shared  buff/cache   available
Mem:           7.8Gi       753Mi       2.9Gi       548Ki       4.4Gi       7.0Gi
Swap:             0B          0B          0B
Compiling tests/test_rosenbrock.cpp...
Running tests/test_rosenbrock...
Running Diagonal Quadratic Test (Ill-conditioned)...
Initial Loss: 50050
Step 1: Loss=50050
Converged in 1 steps.
Final Position: (0, 0)
PASS (Instant Convergence)
[PASS] Test test_rosenbrock
--------------------------------------------------
Running Test test_spectral_whisper...
Disk Usage:
/dev/vdb                  98G   12G   82G  13% /rom/overlay
overlayfs:/overlay/root   98G   12G   82G  13% /
Memory Usage:
               total        used        free      shared  buff/cache   available
Mem:           7.8Gi       760Mi       2.9Gi       548Ki       4.4Gi       7.0Gi
Swap:             0B          0B          0B
Compiling tests/test_spectral_whisper.cpp...
Running tests/test_spectral_whisper...
Testing SpectralWhisper...
Forward Pass Successful.
Output shape: 1 10 128
[PASS] Test test_spectral_whisper
--------------------------------------------------
Running Test test_tensor...
Disk Usage:
/dev/vdb                  98G   12G   82G  13% /rom/overlay
overlayfs:/overlay/root   98G   12G   82G  13% /
Memory Usage:
               total        used        free      shared  buff/cache   available
Mem:           7.8Gi       726Mi       2.9Gi       548Ki       4.4Gi       7.1Gi
Swap:             0B          0B          0B
Compiling tests/test_tensor.cpp...
Running tests/test_tensor...
Testing Tensor Creation...
PASS
Testing Tensor Addition...
PASS
Testing Tensor Matmul (GEMM)...
PASS
Testing Tensor Broadcasting...
PASS
All Tensor tests passed!
[PASS] Test test_tensor
--------------------------------------------------
Running Test test_whisper_recast...
Disk Usage:
/dev/vdb                  98G   12G   82G  13% /rom/overlay
overlayfs:/overlay/root   98G   12G   82G  13% /
Memory Usage:
               total        used        free      shared  buff/cache   available
Mem:           7.8Gi       724Mi       2.9Gi       548Ki       4.4Gi       7.1Gi
Swap:             0B          0B          0B
Compiling tests/test_whisper_recast.cpp...
Running tests/test_whisper_recast...
Loading weights from whisper_spectral_weights.bin...
Found 65 layers in weights file.
Loading distillation data from whisper_layer_data.bin...
Mel Input Shape: 1x80x3000
Running Forward Pass...
Forward pass successful.
Output shape: 1x50x384
[SUCCESS] SpectralWhisper initialized and ran forward pass.
[PASS] Test test_whisper_recast
--------------------------------------------------
Running Test test_wht...
Disk Usage:
/dev/vdb                  98G   12G   82G  13% /rom/overlay
overlayfs:/overlay/root   98G   12G   82G  13% /
Memory Usage:
               total        used        free      shared  buff/cache   available
Mem:           7.8Gi       653Mi       3.0Gi       548Ki       4.4Gi       7.1Gi
Swap:             0B          0B          0B
Compiling tests/test_wht.cpp...
Running tests/test_wht...
Running Identity Test (FWHT(FWHT(x)) / N == x)...
Max diff: 3.57628e-07
PASS
Running Throughput Test...
Allocating 128 MB Tensor...
FWHT Throughput: 2.29112 GB/s
Memcpy Throughput: 4.26683 GB/s
Ratio: 53.696%
PASS (Good)
[PASS] Test test_wht
--------------------------------------------------
Running Test test_xor...
Disk Usage:
/dev/vdb                  98G   12G   82G  13% /rom/overlay
overlayfs:/overlay/root   98G   12G   82G  13% /
Memory Usage:
               total        used        free      shared  buff/cache   available
Mem:           7.8Gi       731Mi       2.9Gi       548Ki       4.4Gi       7.1Gi
Swap:             0B          0B          0B
Compiling tests/test_xor.cpp...
Running tests/test_xor...
Training XOR Network...
Epoch 0, Loss: 0.715185
Epoch 1000, Loss: 0.013546
Epoch 2000, Loss: 0.00549674
Epoch 3000, Loss: 0.00336511
Epoch 4000, Loss: 0.00240241
Epoch 5000, Loss: 0.00185961
Epoch 6000, Loss: 0.00151274
Epoch 7000, Loss: 0.00127244
Epoch 8000, Loss: 0.00109661
Epoch 9000, Loss: 0.000962524
Predictions:
Input [0, 0] -> Prob [0]: 0.997396, [1]: 0.00260364 | Pred: 0 True: 0
Input [0, 1] -> Prob [0]: 0.000324224, [1]: 0.999676 | Pred: 1 True: 1
Input [1, 0] -> Prob [0]: 0.000324118, [1]: 0.999676 | Pred: 1 True: 1
Input [1, 1] -> Prob [0]: 0.999827, [1]: 0.000172726 | Pred: 0 True: 0
Accuracy: 4/4
PASS
[PASS] Test test_xor
--------------------------------------------------
Running Test verify_spectral...
Disk Usage:
/dev/vdb                  98G   12G   82G  13% /rom/overlay
overlayfs:/overlay/root   98G   12G   82G  13% /
Memory Usage:
               total        used        free      shared  buff/cache   available
Mem:           7.8Gi       811Mi       2.8Gi       548Ki       4.4Gi       7.0Gi
Swap:             0B          0B          0B
Compiling tests/verify_spectral.cpp...
Running tests/verify_spectral...
--- Verifying Spectral Parameter Reduction ---
Dimension N = 1024
Dense Layer Parameters: 1049600 (Expected: 1049600)
LinearWHT Layer Parameters: 1024 (Expected: 1024)
Reduction Ratio: 1025x
PASS: Significant parameter reduction observed.
--- Verifying Inverse FWHT ---
Max diff: 5.96046e-07
PASS: Inverse FWHT restores original.
--- Verifying Throughput ---
FWHT Throughput: 2.39179 GB/s
Memcpy Throughput: 4.93566 GB/s
Ratio: 48.4593%
WARNING: Throughput low (48.4593%).
[PASS] Test verify_spectral
--------------------------------------------------
Running Python Tests...
K=1 Rel Error: 0.9937
K=1 Rel Error: 0.9937
K=2 Rel Error: 0.9859
K=3 Rel Error: 0.9778
K=4 Rel Error: 0.9692
K=5 Rel Error: 0.9631
K=6 Rel Error: 0.9555
K=7 Rel Error: 0.9482
K=8 Rel Error: 0.9409
[PASS] test_expressivity.py
--------------------------------------------------
Regression Suite Completed.
